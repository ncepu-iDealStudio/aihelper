import{d as v,a2 as y,_ as h,r as _,j as b,O as U,P as k,Y as a,W as t,a3 as C,c as E,Z as R}from"./vue-c727071f.js";import{u as $,m as N}from"./index-c5ed8602.js";import{e as S,s as q,N as B,t as K}from"./naive_ui-1fdfc3bf.js";const P={class:"flex justify-center items-center mt-20"},D=v({__name:"index",setup(V){const p=y(),{t:i}=h(),r=$(),c=_(),o=b({username:"",password:""}),l=_(!1),f={username:{required:!0,message:i("tips.pleaseEnterUsername"),trigger:"blur"},password:{required:!0,message:i("tips.pleaseEnterPassword"),trigger:"blur"}},d=async()=>{var s;l.value||(s=c.value)==null||s.validate(e=>{e||(l.value=!0)}).then(async()=>{var e;try{await r.login(o);const{redirect:n,...u}=p.currentRoute.value.query;await r.fetchUserInfo(),N.success(i("tips.loginSuccess")),await p.push({name:(e=r.user)!=null&&e.is_superuser?"admin":"conversation"})}catch(n){console.log(n)}finally{l.value=!1}})};return r.user&&p.push({name:"conversation"}),(s,e)=>{const n=S,u=q,w=B,g=K;return U(),k("div",P,[a(g,{ref_key:"formRef",ref:c,model:o,rules:f,"label-col":{span:8},"wrapper-col":{span:16}},{default:t(()=>[a(u,{label:s.$t("commons.username"),path:"username"},{default:t(()=>[a(n,{value:o.username,"onUpdate:value":e[0]||(e[0]=m=>o.username=m),placeholder:s.$t("tips.pleaseEnterUsername"),"input-props":{autoComplete:"username"}},null,8,["value","placeholder"])]),_:1},8,["label"]),a(u,{label:s.$t("commons.password"),path:"password"},{default:t(()=>[a(n,{type:"password","show-password-on":"click",value:o.password,"onUpdate:value":e[1]||(e[1]=m=>o.password=m),placeholder:s.$t("tips.pleaseEnterPassword"),"input-props":{autoComplete:"current-password"},onKeyup:C(d,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["label"]),a(u,{"wrapper-col":"{ span: 16, offset: 8 }"},{default:t(()=>[a(w,{type:"primary",onClick:d,enabled:l.value},{default:t(()=>[E(R(s.$t("commons.login")),1)]),_:1},8,["enabled"])]),_:1})]),_:1},8,["model"])])}}});export{D as default};
//# sourceMappingURL=index-d445b519.js.map
