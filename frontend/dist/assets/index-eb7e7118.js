import{d as v,a2 as y,_ as h,r as _,j as b,N as U,O as k,X as a,V as r,a3 as C,c as E,Y as N}from"./vue-33c36bbc.js";import{u as R,m as $}from"./index-32f447af.js";import{g as q,q as S,N as V,r as B}from"./naive_ui-45b37a56.js";const K={class:"flex justify-center items-center mt-20"},D=v({__name:"index",setup(j){const p=y(),{t:i}=h(),t=R(),c=_(),o=b({username:"",password:""}),l=_(!1),f={username:{required:!0,message:i("tips.pleaseEnterUsername"),trigger:"blur"},password:{required:!0,message:i("tips.pleaseEnterPassword"),trigger:"blur"}},d=async()=>{var s;l.value||(s=c.value)==null||s.validate(e=>{e||(l.value=!0)}).then(async()=>{var e;try{await t.login(o);const{redirect:n,...u}=p.currentRoute.value.query;await t.fetchUserInfo(),$.success(i("tips.loginSuccess")),await p.push({name:(e=t.user)!=null&&e.is_superuser?"admin":"conversation"})}catch(n){console.log(n)}finally{l.value=!1}})};return t.user&&p.push({name:"conversation"}),(s,e)=>{const n=q,u=S,g=V,w=B;return U(),k("div",K,[a(w,{ref_key:"formRef",ref:c,model:o,rules:f,"label-col":{span:8},"wrapper-col":{span:16}},{default:r(()=>[a(u,{label:s.$t("commons.username"),path:"username"},{default:r(()=>[a(n,{value:o.username,"onUpdate:value":e[0]||(e[0]=m=>o.username=m),placeholder:s.$t("tips.pleaseEnterUsername"),"input-props":{autoComplete:"username"}},null,8,["value","placeholder"])]),_:1},8,["label"]),a(u,{label:s.$t("commons.password"),path:"password"},{default:r(()=>[a(n,{type:"password","show-password-on":"click",value:o.password,"onUpdate:value":e[1]||(e[1]=m=>o.password=m),placeholder:s.$t("tips.pleaseEnterPassword"),"input-props":{autoComplete:"current-password"},onKeyup:C(d,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["label"]),a(u,{"wrapper-col":"{ span: 16, offset: 8 }"},{default:r(()=>[a(g,{type:"primary",onClick:d,enabled:l.value},{default:r(()=>[E(N(s.$t("commons.login")),1)]),_:1},8,["enabled"])]),_:1})]),_:1},8,["model"])])}}});export{D as default};
//# sourceMappingURL=index-eb7e7118.js.map
